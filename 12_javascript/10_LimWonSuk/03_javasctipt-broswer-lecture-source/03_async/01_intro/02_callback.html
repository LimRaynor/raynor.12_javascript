<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>callback</title>
</head>
<body>
  <script>
      function login(username, callback) {
          // 지정된 시간(1000ms) 후에 함수 수행 -> 비동기
          setTimeout(() => {
              callback(username);
          }, 1000);
      }

      // login 호출
      login('홍킬동', (username) => {
          console.log(`${username}님 안녕하세요.`);
      });

      // 장바구니에 넣기
      function addCart(product, callback) {
          setTimeout(() => {
              callback(product);
          }, 1000);
      }

      addCart("얼음과자", product => {
          console.log(`${product}를 장바구니에 넣었습니다.`);
      });
      //비동기 호출이라 2개가 서로 기다리지않고 동시에 난옴

      // 결제하기
      function payment(cardNumber, product, callback) {
          setTimeout(() => {
              callback(cardNumber, product);
          }, 1000);
      }

      payment('1112223334445', "얼음과자", (cardNumber, product) => {
          console.log(`${cardNumber.slice(0, 6)}로 ${product}를 구매했습니다.`);
      });



      // call을 연달아 사용하여 비동기 코드를 동기식으로 동작하게 만듬
      login('홍킬동', (username) => {
          console.log("-------------1초 후에 시작-----------")
          console.log(`${username}님 안녕하세요.`);

          addCart("얼음과자", product => {
              console.log(`${product}를 장바구니에 넣었습니다.`);

              payment('1112223334445', "얼음과자", (cardNumber, product) => {
                  console.log(`${cardNumber.slice(0, 6)}로 ${product}를 구매했습니다.`);
              });
          });
      });

      /* 콜백 지옥 */
      function increase(number, callback){
          setTimeout(() => {
              const result = number + 10;
              if (callback) {// 전달받은 함수가 있다면
                  callback(result);
              }
          }, 1000);
      }
      increase(0, result => { // 재귀함수랑 비슷하지만 아니래
          console.log("result : ", result);
          increase(result, result => {
              console.log("result : ", result);
              increase(result, result => {
                  console.log("result : ", result);
              });
          });
      });

  </script>
</body>
</html>